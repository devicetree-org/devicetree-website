<HTML>
<body bgcolor="#ffffff" text="#000000"
link="#0000ff" vlink="#ff0000" alink="ff0000">

<TITLE>
CHRP ISA Serial Port Device Binding
</TITLE>

<center>
<H1>
CHRP<TT>(TM)</TT> ISA Serial Port
<br>
Device Binding to
<br>
<br>
IEEE 1275-1994<br>
Standard for Boot (Initialization,<br>
Configuration) Firmware<br>
</H1>
<br>

Revision: 1.0 Unapproved DRAFT
<br>
<br>

May 6,1996
<br>
</center>
<HR><H2>Table of Contents</H2>

<UL>
<A HREF="serial-1_0d.html#HDR0"><B>1.   Purpose of this Device Binding</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR1"><B>2.   Revision History</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR2"><B>3.   References</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR3"><B>4.   Definition of Terms</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR4"><B>5.   Device Characteristics (Informative)</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR5"><B>6.   Device-specific Configuration Variables</B></A>
<BR>

<A HREF="serial-1_0d.html#HDR6"><B>7.   Device Nodes</B></A>

<UL>
<A HREF="serial-1_0d.html#HDR7">7.1.   Properties</A>

<UL>
<A HREF="serial-1_0d.html#HDR8">7.1.1.   Open Firmware-defined Properties for Device Nodes</A>
<BR>

<A HREF="serial-1_0d.html#HDR9">7.1.2.   Device-specific Properties for Device Nodes</A>
</UL>

<A HREF="serial-1_0d.html#HDR10">7.2.   Methods</A>

<UL>
<A HREF="serial-1_0d.html#HDR11">7.2.1.   Open Firmware-defined Methods for Device Nodes</A>

<UL>
<A HREF="serial-1_0d.html#REF77511">7.2.1.1.   Device Arguments for &quot;Open&quot; Method</A>
</UL>

<A HREF="serial-1_0d.html#HDR12">7.2.2.    Device-specific Methods for Device Nodes</A>
</UL>
</UL>

<A HREF="serial-1_0d.html#HDR13"><B>8.   User Interface Commands</B></A>

<UL>
<A HREF="serial-1_0d.html#HDR14">8.1.   Open Firmware-defined User Interface Commands</A>
<BR>

<A HREF="serial-1_0d.html#HDR15">8.2.   Device-specific User Interface Commands</A>
</UL>

<A HREF="serial-1_0d.html#HDR16"><B>9.   Device State</B></A>

<UL>
<A HREF="serial-1_0d.html#HDR17">9.1.   Device State When Client is Started</A>
<BR>

<A HREF="serial-1_0d.html#HDR18">9.2.   Device State Required When Client Calls Open Firmware</A>
</UL>

<A HREF="serial-1_0d.html#HDR19"><B>10.   Other Commentary</B></A>
</UL>


<HR><!-- This file was created with the fm2html filter.The filter is copyright Norwegian Telecom Research and was programmed by Jon Stephenson von Tetzchner.  --><H2><A NAME="HDR0">1.   Purpose of this Device Binding</A></H2>
This document specifies the application of Open Firmware to PowerPC Common Hardware Reference Platform (CHRP) ISA serial port (UART Controller) devices, including device-specific requirements and practices for initialization, properties, and methods. This device shall be a child of an ISA or EISA Bus Node.<p>
<H2><A NAME="HDR1">2.   Revision History</A></H2>
Revision 1.0 Unapproved DRAFT     ,   Initial revision. Jordan Brown, Sunsoft and John Kingman, IBM editors<p>
<H2><A NAME="HDR2">3.   References</A></H2>
This Open Firmware System binding standard <I>shall</I> be used in conjunction with the following publications. When the following standards are superseded by an approved revision, the revision <I>shall</I> apply.<p>
<DL COMPACT>
<DT><A NAME="REF69242">[1]  </A><DD><I>IEEE Std 1275-1994 Standard for Boot (Initialization, Configuration) Firmware, Core Practices and Requirements</I>.
<DT><A NAME="REF14175">[2]  </A><DD><I>Core Errata, IEEE P1275.7/D4.</I>
<DT><A NAME="REF34886">[3]  </A><DD><I>ISA/EISA/ISA-PnP binding to: IEEE Std 1275-1994, Standard for Boot (Initialization, Configuration) Firmware</I>.
<DT><A NAME="REF86131">[4]  </A><DD><I>Device Support Extensions to: IEEE Std 1275-1994, Standard for Boot (Initialization, Configuration) Firmware</I>.
<DT><A NAME="REF16160">[5]  </A><DD><I>PowerPC Microprocessor Common Hardware Reference Platform: I/O Device Reference</I>. This document describes the PowerPC Common Hardware Reference Platform (CHRP) System Standard I/O Devices; hardware registers, register locations, and hardware attributes.
<DT><A NAME="REF12590">[6]  </A><DD><I>Open Firmware Recommended Practice: Interrupt Mapping</I>.
<DT><A NAME="REF43633">[7]  </A><DD><I>Open Firmware Recommended Practice: Generic Names</I>.
<DT><A NAME="REF92630">[8]  </A><DD><I>PowerPC Microprocessor Common Hardware Reference Platform binding to: IEEE Std 1275-1994, Standard for Boot (Initialization, Configuration) Firmware</I>.
</DL>
<H2><A NAME="HDR3">4.   Definition of Terms</A></H2>
<B>EISA</B>: Extended Industry Standard Architecture<p>
<B>ISA</B>: Industry Standard Architecture<p>
<B>UART</B>: Universal Asynchronous Receiver/Transmitter<p>
<H2><A NAME="HDR4">5.   Device Characteristics (Informative)</A></H2>
The ISA serial port (UART Controller) is one of the most standardized pieces of hardware in the industry, mostly due to the relative lack of support for it in older operating systems and so the tendency for applications programs to directly manipulate it. See <A HREF="serial-1_0d.html#REF16160">[5]</A> for more information.<p>
<H2><A NAME="HDR5">6.   Device-specific Configuration Variables</A></H2>
None.<p>
<H2><A NAME="HDR6">7.   Device Nodes</A></H2>
<H3><A NAME="HDR7">7.1.   Properties</A></H3>
As specified in <A HREF="serial-1_0d.html#REF69242">[1]</A>, <A HREF="serial-1_0d.html#REF34886">[3]</A> and <A HREF="serial-1_0d.html#REF92630">[8]</A>, with the following additions or modifications.<p>
<H4><A NAME="HDR8">7.1.1.   Open Firmware-defined Properties for Device Nodes</A></H4>
<H4>  &quot;name&quot;    S</H4>
Standard <I>property name</I>, specifies the generic name of the device. <p>
The meaning of this property is as defined in Open Firmware core document <A HREF="serial-1_0d.html#REF69242">[1]</A>, as modified by the <I>Generic Names Recommended Practice</I> <A HREF="serial-1_0d.html#REF43633">[7]</A>. The value for nodes described by this specification shall be &quot;serial&quot;.<p>
<H4>  &quot;device_type&quot;    S</H4>
Standard <I>property name</I> to define the device's implemented interface. <p>
The meaning of this property is as defined in the Open Firmware core document <A HREF="serial-1_0d.html#REF69242">[1]</A>. The value for nodes described by this specification shall be &quot;serial&quot;.<p>
<H4>  &quot;compatible&quot;    S</H4>
Standard <I>property name</I>, specifies device names with which this device is compatible. <p>
The meaning of this property is as defined in Open Firmware, as modified by the <I>Generic Names Recommended Practice</I> <A HREF="serial-1_0d.html#REF43633">[7]</A>. As described in those documents, the entries are a list of device names with which this device is compatible, starting with the name of the device itself and progressing through successively less precise and possibly less functional compatible devices.<p>
For this device, the compatible property shall include &quot;pnpPNP,501.&quot; <p>
Additional entries may be supplied, at their appropriate position in the list, to describe devices with which this device is compatible.<p>
<H4>  &quot;reg&quot;    S</H4>
Standard <I>property name</I> to define the package's registers. <p>
The meaning of this property is as defined in the Open Firmware core document <A HREF="serial-1_0d.html#REF69242">[1]</A>. It describes the device's register set. The values which shall be assigned to this property are explained in the <I>ISA/EISA/ISA-PnP binding</I><A HREF="serial-1_0d.html#REF34886">[3]</A> and the <I>I/O Device Reference</I><A HREF="serial-1_0d.html#REF16160">[5]</A><p>
<H4>  &quot;interrupts&quot;    S</H4>
Standard <I>property name</I> to define the package's interrupts. <p>
The meaning of this property is as defined in the <I>Interrupt Mapping Recommended Practice</I> <A HREF="serial-1_0d.html#REF12590">[6]</A>. The values assigned to this property are explained in the <I>ISA/EISA/ISA-PnP binding</I><A HREF="serial-1_0d.html#REF34886">[3]</A> and the <I>I/O Device Reference</I><A HREF="serial-1_0d.html#REF16160">[5]</A>.<p>
<H4><A NAME="HDR9">7.1.2.   Device-specific Properties for Device Nodes</A></H4>
As specified in <A HREF="serial-1_0d.html#REF34886">[3]</A>, with the following addition.<p>
<H4>  &quot;clock-frequency&quot;    S</H4>
Standard property, encoded as with encode-int, that shall be the baud-rate generator's clock input frequency (in hertz).<p>
Typically, the clock frequency is nominally 1,843,200 Hz. Some devices generate the baud rate input clock by dividing a higher-frequency clock source that is not an exact multiple of 1,843,200 Hz, resulting in a small but acceptable error in the nominal clock frequency. In such cases, the &quot;clock-frequency&quot; shall report the actual nominal frequency. For example, if the baud rate input clock is generated by dividing a 24 MHz clock by 13, the value of the &quot;clock-frequency&quot; property shall be 1846153.<p>
<H3><A NAME="HDR10">7.2.   Methods</A></H3>
<H4><A NAME="HDR11">7.2.1.   Open Firmware-defined Methods for Device Nodes</A></H4>
As specified in <A HREF="serial-1_0d.html#REF69242">[1]</A> and <A HREF="serial-1_0d.html#REF34886">[3]</A>, with the following addition or modification. This device shall be have its interrupt lines &quot;tri-stated&quot; when closed.<p>
<H5><A NAME="REF77511">7.2.1.1.   Device Arguments for &quot;Open&quot; Method</A></H5>
As specified in <A HREF="serial-1_0d.html#REF69242">[1]</A>, <A HREF="serial-1_0d.html#REF34886">[3]</A> and [4], with the following addition or modification.<p>
<B>open </B>is a Standard<B> </B>Method for the Serial Device. When the Serial Device is opened, several device-arguments can be passed as defined below: <p>
driver-name@unit-address:<B>device-arguments</B><p>
<B>device-arguments</B> are defined to be of the form, e.g. 9600,8,n,1, and sets the UART parameters (baudrate,  #data bits, parity, #stop bits, and handshake) accordingly.<p>
The fields are (in order, left to right):<p>
&lt;baud rate&gt;, &lt;data bits&gt;, &lt;parity&gt;, &lt;stop bits&gt;, &lt;handshake&gt;<p>
Fields with empty values are not changed. Values for fields are whatever the hardware will support:<p>
baud rates: various, including 110, 300, 1200, 2400, 4800, 9600, 19200, 38400<p>
character bits: 5,6,7,8<p>
parity:<p>
<pre>
-----------
char  means  
-----------
n     none   
e     even   
o     odd    
m     mark   
s     space  
-----------
</pre>
stop bits:<p>
<pre>
-------------------
char  means          
-------------------
1     1 stop bit     
.     1.5 stop bits  
2     2 stop bits    
-------------------
</pre>
handshake:<p>
<pre>
-------------------------------------
char  means                            
-------------------------------------
-     none                             
h     hardware (rts/cts) \ Not supported   
s     software (xon/xoff) \ Not supported  
-------------------------------------
</pre>
The default mode is 9600,8,n,1,-<p>
<H4><A NAME="HDR12">7.2.2.    Device-specific Methods for Device Nodes</A></H4>
As specified in <A HREF="serial-1_0d.html#REF69242">[1]</A> and <A HREF="serial-1_0d.html#REF34886">[3]</A>, with the following additions.<p>
<H4>  set-mode   ( adr len -- )  M</H4>
Sets the device mode according to the string at <I>adr</I>, of length <I>len</I>, which is interpreted the same as the arguments to the "open" method (see <A HREF="serial-1_0d.html#REF77511">Section 7.2.1.1. on page 5</A>).<p>
<H4>  set-modem-control   ( bitmask -- )  M</H4>
Sets the device's modem control lines according to the following table:<p>
<pre>
----------------------------
bitmask  Modem control state  
----------------------------
0        RTS off, DTR off     
1        RTS off, DTR on      
2        RTS on, DTR off      
3        RTS on, DTR on       
----------------------------
</pre>
The response for other values of <I>bitmask</I> are implementation dependent. <p>
Changing the bits associated with these lines shall have no effect on other bits not associated with this function.<p>
<H2><A NAME="HDR13">8.   User Interface Commands</A></H2>
<H3><A NAME="HDR14">8.1.   Open Firmware-defined User Interface Commands</A></H3>
None.<p>
<H3><A NAME="HDR15">8.2.   Device-specific User Interface Commands</A></H3>
None.<p>
<H2><A NAME="HDR16">9.   Device State</A></H2>
<H3><A NAME="HDR17">9.1.   Device State When Client is Started</A></H3>
For devices not selected as Open Firmware's &quot;console input device&quot; or &quot;console output device&quot; device, most of the initial state is typically undefined. This device shall be closed when the client is started, if it is not selected as Open Firmware's &quot;console input device&quot; or &quot;console output device&quot; device.<p>
For devices which are selected as Open Firmware's &quot;console input device&quot; or &quot;console output device&quot; device, the device shall be initialized appropriately for the device to which it is attached.<p>
Refer to <A HREF="serial-1_0d.html#REF16160">[5]</A> for more information on the state of this device when the client is started.<p>
<H3><A NAME="HDR18">9.2.   Device State Required When Client Calls Open Firmware</A></H3>
For devices not selected as Open Firmware's &quot;console input device&quot; or &quot;console output device&quot; device, there is no requirement.<p>
For devices selected as Open Firmware's &quot;console input device&quot; or &quot;console output device&quot; device, the state should be unmodified from the initial state on client start-up.<p>
Note:  If the device is in a different state when the client calls Open Firmware, unpredictable behavior may result if Open Firmware accepts input or generates output. Clients changing the device state should either restore the original state before calling Open Firmware or should avoid using Open Firmware features requiring user interaction. Changing the device state is likely to render Open Firmware unusable for debugging purposes.<p>
<H2><A NAME="HDR19">10.   Other Commentary</A></H2>
<A NAME="ENDFILE"><PRE> </PRE></A>
</HTML>
