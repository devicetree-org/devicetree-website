---
import dayjs from "dayjs";

function dateConvertor(text: string) {
  const dateObj = dayjs(text);
  const dateString = dateObj.format("dddd, MMMM D, YYYY");
  return dateString;
}

const api =
  "https://api.github.com/repos/devicetree-org/devicetree-specification/releases";

async function fetchData() {
  const response = await fetch(api);
  console.log(response);
  const data = await response.json();
  console.log(data);
  return data;
}

const data_releases = await fetchData();
console.log(data_releases);
---

<div class="lg:px-[190px]">
  <h2 class="font-bold">The Devicetree Specification</h2>
  <h2>Current Release</h2>
  <div class="text-xl mb-4">
    <a href={data_releases[0].html_url} class="text-primary">
      DeviceTree Specification Release
      {data_releases[0].tag_name}
    </a>
    <span class="text-black"> - Released {data_releases[0].created_at}</span>
    <span
      class="text-[#2cbe4e] p-[5px] border border-[#2cbe4e] text-xs align-middle relative ml-2"
      >Latest Release</span
    >
  </div>
  <h2>Past Releases</h2>
  {
    data_releases.slice(1, 5).map((item: any) => (
      <div id={item.id}>
        <div class="text-xl mb-4  ">
          <a href={item.html_url} class="text-primary">
            DeviceTree Specification Release
            {item.tag_name}
          </a>
          <span class="text-black">
            - Released {dateConvertor(item.created_at)}
          </span>
        </div>
      </div>
    ))
  }
</div>
